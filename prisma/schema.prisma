// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  clerkId   String  @id @unique
  userName  String  @default("")
  email     String  @unique
  firstName String
  lastName  String
  photo     String  @default("")
  verified  Boolean @default(false)
  order     Order[]

  @@index([email])
}

model Order {
  id          String   @id @default(uuid())
  user        User     @relation(fields: [createdBy], references: [clerkId])
  createdBy   String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  totalAmount Float
  status      String   @default("pending")
  pickupTime  DateTime
  items       Cart[]   @relation("OrderItems")
  customer    Customer @relation("CustomerOrders", fields: [customerId], references: [id],onDelete: Cascade,onUpdate: Cascade )
  customerId  String

  @@index([createdBy])
}
model Cart {
  id        String   @id @default(uuid())
  items     Item   @relation("cartItems", fields: [itemId], references: [id],onDelete: Cascade,onUpdate: Cascade)
  itemId    String
  quanity    Int @default(1)
  order     Order  @relation("OrderItems",fields: [orderId], references: [id],onDelete: Cascade,onUpdate: Cascade)
  orderId   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

}
model Item {
  id          String     @id @default(uuid())
  name        String
  description String?
  price       Float
  images      String[]
  dietary     Dietary[]
  size        Size[]
  category    Category[] @relation("CategoryItems")
  cart        Cart[]     @relation("cartItems")

  @@index([id])
}

model Category {
  id    String     @id @default(uuid())
  name  Categories
  items Item[]     @relation("CategoryItems")

  @@index([name])
}

model Customer {
  id        String   @id @default(uuid())
  firstName String
  lastName  String
  email     String?  @unique
  phone     String
  address   String?
  city      String?
  state     String?
  postCode  String?
  country   String?  @default("Australia")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  orders    Order[]  @relation("CustomerOrders")

  @@index([email])
}

enum Categories {
  CHICKEN
  SALAD
  SIDES
  SHARING_BOXES
  DESSERTS
  DRINKS
  SAUCES
  FINGER_FOOD
}

enum Dietary {
  VEGAN
  VEGETARIAN
  GLUTEN_FREE
  DAIRY_FREE
  NUT_FREE
}

enum Size {
  REGULAR
  LARGE
  FAMILY
  EXTRA_LARGE
  SMALL
  MEDIUM
}
